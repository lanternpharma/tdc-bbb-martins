# Lantern Pharma: Blood-Brain-Barrier Permeability
**Lantern Pharma** presents this public repository for predicting a drug's ability to penetrate the blood brain barrier for Theraputic Data Commons BBB-Martins et al leaderboard

Information and data used for the project, can be found on the following TDC site:
https://tdcommons.ai/single_pred_tasks/adme/#bbb-blood-brain-barrier-martins-et-al

**Dataset Description:** As a membrane separating circulating blood and brain extracellular fluid, the blood-brain barrier (BBB) is the protection layer that blocks most foreign drugs. Thus the ability of a drug to penetrate the barrier to deliver to the site of action forms a crucial challenge in development of drugs for central nervous system From MoleculeNet.

**Task Description:** Binary classification. Given a drug SMILES string, predict the activity of BBB.
Dataset Statistics: 1,975 drugs.

**Approach:**
SMILES strings for each drug were transformed into machine learning features using RDKit tools, more information on the package resources is located here:
https://rdkit.org

# Installation

**Clone this repository as follows:**

```
git clone https://github.com/lanternpharma/tdc-bbb-martins
```

**Use conda to install all the required dependencies in a virtual environment. Use the `env.yml` file to create and activate the environment as follows.**

```
conda env create -f environment/conda_env.yml 
conda activate tdc
```

# Models included in this repository:
Each model method along with associated data pre-processing and feature selection can be trained and produce predictions in the primary run shell script assuming the features have been generated and exist in the 'code/data/' folder

**Logistic Regression:** contained in the logistic.py script, this model uses fingerprints, autocorrelations, and 2D & 3D descriptors associated with known drug filters generated by RDKit as primary features along with additional engineered features that are then transformed with a kernel pca. Lasso feature selection is performed on the k-pca features prior to model training

**Deep Neural Network:** contained in the dnn.py script, this model uses fingerprints, autocorrelations, and 2D & 3D descriptors associated with known drug filters generated by RDKit as primary features along with additional engineered features that are then transformed with a kernel pca. Lasso feature selection is performed on the k-pca features then SMOTE sugmentation for class imbalance is done prior to model training

**Random Forest:** contained in the rf.py script, this model uses fingerprints, autocorrelations, and 2D & 3D descriptors associated with known drug filters generated by RDKit as primary features along with additional engineered features and data augmentation is performed before feature selection and model training

**Support Vector Machine (SVM):** contained in the svm_linear.py script, this model uses fingerprints, autocorrelations, and 2D & 3D descriptors associated with known drug filters generated by RDKit as primary features along with additional engineered features that are then transformed with a kernel pca. Lasso feature selection is performed on the k-pca features then SMOTE sugmentation for class imbalance is done prior to model training

**Ensemble:** contained in the ensemble.py script, this model uses the deep neural network, random forest and SVM models above as base learners that feed into a second-level logistic regression meta-learner to ensemble predictions

# Running the models to reproduce results

With conda environment activated, change to the "code" directory then execute the shell script as follows to run all available model types:
```
sh run
```

The default run took about 8 hours on a MacBook M1 with 16 Gb RAM circa (March 2023).

If you need to regenerate the features required for the model scripts the following run script is also available:

```
run_feature_generation

```

# Summary of model results


| Model                     	|     AU-ROC    	|    Accuracy   	|  Sensitivity  	|  Specificity  	|
|---------------------------	|:-------------:	|:-------------:	|:-------------:	|:-------------:	|
| Ensemble                  	| 0.915 ± 0.003 	| 0.879 ± 0.007 	| 0.915 ± 0.009 	| 0.726 ± 0.033 	|
| Deep Neural Network (DNN) 	| 0.912 ± 0.003 	| 0.893 ± 0.009 	| 0.947 ± 0.013 	| 0.664 ± 0.033 	|
| Random Forest (RF)        	| 0.907 ± 0.006 	| 0.891 ± 0.007 	| 0.955 ± 0.007 	| 0.621 ± 0.037 	|
| SVM-linear                	| 0.905 ± 0.008 	| 0.898 ± 0.006 	| 0.965 ± 0.008 	| 0.615 ± 0.024 	|
| Logistic Regression       	| 0.903 ± 0.002 	| 0.896 ± 0.001 	| 0.970 ± 0.003 	| 0.582 ± 0.007 	|



## License
Copyright (c) 2023 Lantern Pharma Inc.

This project is licensed under the GNU Affero General Public License version 3.0. See the [LICENSE](LICENSE) file for license rights and limitations (AGPLv3).
